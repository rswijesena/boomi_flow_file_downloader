!function(t){function e(n){if(o[n])return o[n].exports;var r=o[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var o in t)e.hasOwnProperty(o)||(e[o]=t[o])}(o(1))},function(t,e,o){"use strict";function n(){var t=[];for(var e in manywho.OutcomeTimers){var o=manywho.OutcomeTimers[e];o&&t.push(r(o))}Promise.all(t)}function r(t){return t.startCounting(),!0}var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0}),manywho.OutcomeTimers={},manywho.CustomComponentOrchestrator?manywho.CustomComponentOrchestrator.doneSendHandlers.push(n):manywho.settings.initialize({},{invoke:{done:n}});var s=o(2);o(3);var a=function(t){function e(e){var o=t.call(this,e)||this;o.componentId="",o.flowKey="",o.attributes=new Map,o.timerId=-1,o.timerCounter=0,o.componentId=e.id,o.flowKey=e.flowKey;var n=manywho.model.getComponent(o.componentId,o.flowKey);if(n.attributes)for(var r in n.attributes)o.attributes.set(r,n.attributes[r]);return n.objectData&&n.objectData[0]&&manywho.state.setComponent(o.componentId,{objectData:[n.objectData[0]]},o.flowKey,!0),o}return i(e,t),e.prototype.getAttribute=function(t,e){return this.attributes.has(t)?this.attributes.get(t):e},e.prototype.componentDidMount=function(){manywho.OutcomeTimers[this.componentId]=this,this.startCounting()},e.prototype.componentWillUnmount=function(){clearInterval(this.timerId),this.timerId=-1},e.prototype.startCounting=function(){this.timerCounter=0,this.timerId=window.setInterval(this.timerHandler.bind(this),1e3)},e.prototype.timerHandler=function(){var t=manywho.state.getComponent(this.componentId,this.flowKey);if(t&&t.loading)this.timerCounter=0,this.forceUpdate();else if(this.timerCounter<parseInt(this.getAttribute("refreshIntervalSeconds",10)))this.timerCounter++,this.forceUpdate();else{this.timerCounter=0,this.timerId>=-1&&(clearInterval(this.timerId),this.timerId=-1);var e=this.getAttribute("refreshOutcomeId","");if(e&&e.length>0&&"null"!=e.toLowerCase()){var o=manywho.model.getOutcome(e,this.flowKey);return!o||manywho.component.onOutcome(o,null,this.flowKey)}var n=this.getAttribute("refreshComponentId","");if(n&&n.length>0){var r=this,i=manywho.model.getComponent(this.props.id,this.props.flowKey).objectDataRequest;manywho.engine.objectDataRequest(this.props.id,i,this.props.flowKey,0,null,null,null,null).then(function(){var t=manywho.model.getComponent(n,r.props.flowKey);t&&(t.objectData=manywho.model.getComponent(r.props.id,r.props.flowKey).objectData,manywho.engine.render(r.props.flowKey))})}}},e.prototype.render=function(){var t=parseInt(this.getAttribute("refreshIntervalSeconds",10))-this.timerCounter;return s.createElement("div",null,"Triggering outcome in ",t," seconds")},e}(s.Component);manywho.component.register("OutcomeTimer",a),e.default=a},function(t,e){t.exports=React},function(t,e){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vT3V0Y29tZVRpbWVyLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAzM2U2NzQ2YWQwOTYxNDY1YTQ5YSIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXgudHN4Iiwid2VicGFjazovLy8uL3NyYy9PdXRjb21lVGltZXIudHN4Iiwid2VicGFjazovLy9leHRlcm5hbCBcIlJlYWN0XCIiXSwibmFtZXMiOlsibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJuIiwiX19lc01vZHVsZSIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsInZhbHVlIiwiZG9uZUhhbmRsZXIiLCJwcm9taXNlcyIsImtleSIsIm1hbnl3aG8iLCJPdXRjb21lVGltZXJzIiwidGltZXIiLCJwdXNoIiwidHJpZ2dlclRpbWVyIiwiUHJvbWlzZSIsImFsbCIsInN0YXJ0Q291bnRpbmciLCJfX2V4dGVuZHMiLCJ0aGlzIiwiZXh0ZW5kU3RhdGljcyIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiQXJyYXkiLCJiIiwiX18iLCJjb25zdHJ1Y3RvciIsImNyZWF0ZSIsIkN1c3RvbUNvbXBvbmVudE9yY2hlc3RyYXRvciIsImRvbmVTZW5kSGFuZGxlcnMiLCJzZXR0aW5ncyIsImluaXRpYWxpemUiLCJpbnZva2UiLCJkb25lIiwiUmVhY3QiLCJPdXRjb21lVGltZXIiLCJfc3VwZXIiLCJwcm9wcyIsIl90aGlzIiwiY29tcG9uZW50SWQiLCJmbG93S2V5IiwiYXR0cmlidXRlcyIsIk1hcCIsInRpbWVySWQiLCJ0aW1lckNvdW50ZXIiLCJpZCIsImZsb3dNb2RlbCIsIm1vZGVsIiwiZ2V0Q29tcG9uZW50Iiwic2V0Iiwib2JqZWN0RGF0YSIsInN0YXRlIiwic2V0Q29tcG9uZW50IiwiZ2V0QXR0cmlidXRlIiwiYXR0cmlidXRlTmFtZSIsImRlZmF1bHRWYWx1ZSIsImhhcyIsImNvbXBvbmVudERpZE1vdW50IiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJjbGVhckludGVydmFsIiwid2luZG93Iiwic2V0SW50ZXJ2YWwiLCJ0aW1lckhhbmRsZXIiLCJiaW5kIiwiZmxvd1N0YXRlIiwibG9hZGluZyIsImZvcmNlVXBkYXRlIiwicGFyc2VJbnQiLCJvdXRjb21lVG9UcmlnZ2VyIiwibGVuZ3RoIiwidG9Mb3dlckNhc2UiLCJvdXRjb21lIiwiZ2V0T3V0Y29tZSIsImNvbXBvbmVudCIsIm9uT3V0Y29tZSIsImNvbXBvbmVudFRvVXBkYXRlIiwic2VsZiIsInJlcXVlc3QiLCJvYmplY3REYXRhUmVxdWVzdCIsImVuZ2luZSIsInRoZW4iLCJyZW5kZXIiLCJyZW1haW5pbmciLCJjcmVhdGVFbGVtZW50IiwiQ29tcG9uZW50IiwicmVnaXN0ZXIiLCJkZWZhdWx0Il0sIm1hcHBpbmdzIjoiQ0FBUyxTQUFVQSxHQ0luQixRQUFBQyxHQUFBQyxHQUdBLEdBQUFDLEVBQUFELEdBQ0EsTUFBQUMsR0FBQUQsR0FBQUUsT0FHQSxJQUFBQyxHQUFBRixFQUFBRCxJQUNBSSxFQUFBSixFQUNBSyxHQUFBLEVBQ0FILFdBVUEsT0FOQUosR0FBQUUsR0FBQU0sS0FBQUgsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUgsR0FHQUksRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQXZCQSxHQUFBRCxLQTRCQUYsR0FBQVEsRUFBQVQsRUFHQUMsRUFBQVMsRUFBQVAsRUFHQUYsRUFBQVUsRUFBQSxTQUFBUCxFQUFBUSxFQUFBQyxHQUNBWixFQUFBYSxFQUFBVixFQUFBUSxJQUNBRyxPQUFBQyxlQUFBWixFQUFBUSxHQUNBSyxjQUFBLEVBQ0FDLFlBQUEsRUFDQUMsSUFBQU4sS0FNQVosRUFBQW1CLEVBQUEsU0FBQWYsR0FDQSxHQUFBUSxHQUFBUixLQUFBZ0IsV0FDQSxXQUEyQixNQUFBaEIsR0FBQSxTQUMzQixXQUFpQyxNQUFBQSxHQUVqQyxPQURBSixHQUFBVSxFQUFBRSxFQUFBLElBQUFBLEdBQ0FBLEdBSUFaLEVBQUFhLEVBQUEsU0FBQVEsRUFBQUMsR0FBc0QsTUFBQVIsUUFBQVMsVUFBQUMsZUFBQWpCLEtBQUFjLEVBQUFDLElBR3REdEIsRUFBQXlCLEVBQUEsR0FHQXpCLElBQUEwQixFQUFBLEtETU0sU0FBVXRCLEVBQVFELEVBQVNILEdBRWpDLFlBS0FjLFFBQU9DLGVBQWVaLEVBQVMsY0FBZ0J3QixPQUFPLElBSHRELFNBQWtCbkIsR0FDZCxJQUFLLEdBQUlpQixLQUFLakIsR0FBUUwsRUFBUXFCLGVBQWVDLEtBQUl0QixFQUFRc0IsR0FBS2pCLEVBQUVpQixLRXhFcEV6QixFQUFBLEtGZ0ZNLFNBQVVJLEVBQVFELEVBQVNILEdBRWpDLFlHekRBLFNBQUE0QixLQUdJLEdBRUlDLEtBRUosS0FBSSxHQUFJQyxLQUFPQyxTQUFRQyxjQUN2QixDQUNJLEdBQUlDLEdBQXVCRixRQUFRQyxjQUFjRixFQUU5Q0csSUFFQ0osRUFBU0ssS0FBS0MsRUFBYUYsSUFJbkNHLFFBQVFDLElBQUlSLEdBR2hCLFFBQUFNLEdBQXNCRixHQUtsQixNQURBQSxHQUFNSyxpQkFDQyxFSGtDWCxHQUFJQyxHQUFhQyxNQUFRQSxLQUFLRCxXQUFjLFdBQ3hDLEdBQUlFLEdBQWdCM0IsT0FBTzRCLGlCQUNwQkMsdUJBQTJCQyxRQUFTLFNBQVVsQyxFQUFHbUMsR0FBS25DLEVBQUVpQyxVQUFZRSxJQUN2RSxTQUFVbkMsRUFBR21DLEdBQUssSUFBSyxHQUFJcEIsS0FBS29CLEdBQU9BLEVBQUVyQixlQUFlQyxLQUFJZixFQUFFZSxHQUFLb0IsRUFBRXBCLElBQ3pFLE9BQU8sVUFBVWYsRUFBR21DLEdBRWhCLFFBQVNDLEtBQU9OLEtBQUtPLFlBQWNyQyxFQURuQytCLEVBQWMvQixFQUFHbUMsR0FFakJuQyxFQUFFYSxVQUFrQixPQUFOc0IsRUFBYS9CLE9BQU9rQyxPQUFPSCxJQUFNQyxFQUFHdkIsVUFBWXNCLEVBQUV0QixVQUFXLEdBQUl1QixPQUd2RmhDLFFBQU9DLGVBQWVaLEVBQVMsY0FBZ0J3QixPQUFPLElHM0Z0REksUUFBUUMsaUJBR0xELFFBQVFrQiw0QkFFUGxCLFFBQVFrQiw0QkFBNEJDLGlCQUFpQmhCLEtBQUtOLEdBSTFERyxRQUFRb0IsU0FBU0MsZUFLVEMsUUFFS0MsS0FBTTFCLElBb0N2QixJQUFBMkIsR0FBQXZELEVBQUEsRUFDQUEsR0FBQSxFQUVBLElBQUF3RCxHQUFBLFNBQUFDLEdBV0ksUUFBQUQsR0FBWUUsR0FBWixHQUFBQyxHQUVJRixFQUFBbEQsS0FBQWlDLEtBQU1rQixJQUFNbEIsSUFWaEJtQixHQUFBQyxZQUFzQixHQUN0QkQsRUFBQUUsUUFBaUIsR0FDakJGLEVBQUFHLFdBQWEsR0FBSUMsS0FHakJKLEVBQUFLLFNBQVcsRUFDWEwsRUFBQU0sYUFBZSxFQU1YTixFQUFLQyxZQUFjRixFQUFNUSxHQUN6QlAsRUFBS0UsUUFBVUgsRUFBTUcsT0FHM0IsSUFBSU0sR0FBWXBDLFFBQVFxQyxNQUFNQyxhQUFhVixFQUFLQyxZQUFlRCxFQUFLRSxRQUNwRSxJQUFHTSxFQUFVTCxXQUVaLElBQUksR0FBSWhDLEtBQU9xQyxHQUFVTCxXQUV4QkgsRUFBS0csV0FBV1EsSUFBSXhDLEVBQUtxQyxFQUFVTCxXQUFXaEMsR0hvRTFDLE9HaEVHcUMsR0FBVUksWUFBY0osRUFBVUksV0FBVyxJQUU1Q3hDLFFBQVF5QyxNQUFNQyxhQUFhZCxFQUFLQyxhQUFjVyxZQUFhSixFQUFVSSxXQUFXLEtBQU1aLEVBQUtFLFNBQVMsR0g4RGpHRixFR3NEZixNQWxKMkJwQixHQUFBaUIsRUFBQUMsR0FrQ3ZCRCxFQUFBakMsVUFBQW1ELGFBQUEsU0FBYUMsRUFBd0JDLEdBRXZDLE1BQUdwQyxNQUFLc0IsV0FBV2UsSUFBSUYsR0FFZm5DLEtBQUtzQixXQUFXNUMsSUFBSXlELEdBSXBCQyxHQUlOcEIsRUFBQWpDLFVBQUF1RCxrQkFBQSxXQUVJL0MsUUFBUUMsY0FBY1EsS0FBS29CLGFBQWVwQixLQUMxQ0EsS0FBS0YsaUJBR1RrQixFQUFBakMsVUFBQXdELHFCQUFBLFdBR0lDLGNBQWN4QyxLQUFLd0IsU0FDbkJ4QixLQUFLd0IsU0FBVyxHQUdwQlIsRUFBQWpDLFVBQUFlLGNBQUEsV0FFSUUsS0FBS3lCLGFBQWUsRUFDcEJ6QixLQUFLd0IsUUFBVWlCLE9BQU9DLFlBQVkxQyxLQUFLMkMsYUFBYUMsS0FBSzVDLE1BQU8sTUFJcEVnQixFQUFBakMsVUFBQTRELGFBQUEsV0FFSSxHQUFNRSxHQUFZdEQsUUFBUXlDLE1BQU1ILGFBQWE3QixLQUFLb0IsWUFBYXBCLEtBQUtxQixRQUVwRSxJQUFHd0IsR0FBYUEsRUFBVUMsUUFFdEI5QyxLQUFLeUIsYUFBZSxFQUNwQnpCLEtBQUsrQyxrQkFJTCxJQUFHL0MsS0FBS3lCLGFBQWV1QixTQUFTaEQsS0FBS2tDLGFBQWEseUJBQTBCLEtBRXhFbEMsS0FBS3lCLGVBQ0x6QixLQUFLK0Msa0JBR1QsQ0FFSS9DLEtBQUt5QixhQUFlLEVBR2pCekIsS0FBS3dCLFVBQVksSUFFaEJnQixjQUFjeEMsS0FBS3dCLFNBQ25CeEIsS0FBS3dCLFNBQVcsRUFHcEIsSUFBSXlCLEdBQW1CakQsS0FBS2tDLGFBQWEsbUJBQW9CLEdBRTdELElBQUdlLEdBQW9CQSxFQUFpQkMsT0FBUyxHQUF1QyxRQUFsQ0QsRUFBaUJFLGNBQ3ZFLENBQ0ksR0FBSUMsR0FBVTdELFFBQVFxQyxNQUFNeUIsV0FBV0osRUFBa0JqRCxLQUFLcUIsUUFHOUQsUUFBRytCLEdBR1E3RCxRQUFRK0QsVUFBVUMsVUFBVUgsRUFBUyxLQUFPcEQsS0FBS3FCLFNBUWhFLEdBQUltQyxHQUFvQnhELEtBQUtrQyxhQUFhLHFCQUFzQixHQUVoRSxJQUFHc0IsR0FBcUJBLEVBQWtCTixPQUFTLEVBQ25ELENBRUksR0FBSU8sR0FBT3pELEtBR1AwRCxFQUFVbkUsUUFBUXFDLE1BQU1DLGFBQWE3QixLQUFLa0IsTUFBTVEsR0FBTTFCLEtBQUtrQixNQUFNRyxTQUFTc0MsaUJBRzlFcEUsU0FBUXFFLE9BQU9ELGtCQUFrQjNELEtBQUtrQixNQUFNUSxHQUFJZ0MsRUFBUzFELEtBQUtrQixNQUFNRyxRQUFTLEVBQUksS0FBTSxLQUFNLEtBQU0sTUFDbEd3QyxLQUFLLFdBRUYsR0FBSVAsR0FBWS9ELFFBQVFxQyxNQUFNQyxhQUFhMkIsRUFBbUJDLEVBQUt2QyxNQUFNRyxRQUd0RWlDLEtBRUNBLEVBQVV2QixXQUFXeEMsUUFBUXFDLE1BQU1DLGFBQWE0QixFQUFLdkMsTUFBTVEsR0FBSStCLEVBQUt2QyxNQUFNRyxTQUFTVSxXQUNuRnhDLFFBQVFxRSxPQUFPRSxPQUFRTCxFQUFLdkMsTUFBTUcsZUFRMURMLEVBQUFqQyxVQUFBK0UsT0FBQSxXQUVJLEdBQUlDLEdBQVlmLFNBQVNoRCxLQUFLa0MsYUFBYSx5QkFBMEIsS0FBUWxDLEtBQUt5QixZQUVsRixPQUFPVixHQUFBaUQsY0FBQSxXSDBCSCx5QkcxQitCRCxFSDRCL0IsYUcxQlovQyxHQWxKMkJELEVBQU1rRCxVQW9KakMxRSxTQUFRK0QsVUFBVVksU0FBUyxlQUFnQmxELEdBRTNDckQsRUFBQXdHLFFBQWVuRCxHSGdDVCxTQUFVcEQsRUFBUUQsR0loUHhCQyxFQUFBRCxRQUFBb0QsT0pzUE0sU0FBVW5ELEVBQVFEIiwiZmlsZSI6Ik91dGNvbWVUaW1lci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbi8qKioqKiovIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbi8qKioqKiovIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbi8qKioqKiovIFx0XHRcdH0pO1xuLyoqKioqKi8gXHRcdH1cbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKFtcbi8qIDAgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cclxuZnVuY3Rpb24gX19leHBvcnQobSkge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuX19leHBvcnQoX193ZWJwYWNrX3JlcXVpcmVfXygxKSk7XHJcblxuXG4vKioqLyB9KSxcbi8qIDEgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXCJ1c2Ugc3RyaWN0XCI7XG5cclxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xyXG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxuICAgIH07XHJcbn0pKCk7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxubWFueXdoby5PdXRjb21lVGltZXJzID0ge307XHJcbi8vIHRoaXMgYXR0YWNoZXMgdGhlIEFqYXggaGFuZGxlcnMgdG8gdGhlIG1hbnl3aG8uQ3VzdG9tQ29tcG9uZW50T3JjaGVzdHJhdG9yIG9yIFxyXG4vLyBpbml0aWFsaXplIGZ1bmN0aW9uIGlmIG1hbnl3aG8uQ3VzdG9tQ29tcG9uZW50T3JjaGVzdHJhdG9yIGlzbnQgZGVmaW5lZC4gIFxyXG5pZiAobWFueXdoby5DdXN0b21Db21wb25lbnRPcmNoZXN0cmF0b3IpIHtcclxuICAgIG1hbnl3aG8uQ3VzdG9tQ29tcG9uZW50T3JjaGVzdHJhdG9yLmRvbmVTZW5kSGFuZGxlcnMucHVzaChkb25lSGFuZGxlcik7XHJcbn1cclxuZWxzZSB7XHJcbiAgICBtYW55d2hvLnNldHRpbmdzLmluaXRpYWxpemUoe30sIHtcclxuICAgICAgICBpbnZva2U6IHtcclxuICAgICAgICAgICAgZG9uZTogZG9uZUhhbmRsZXJcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5mdW5jdGlvbiBkb25lSGFuZGxlcigpIHtcclxuICAgIC8vcHJlc2VydmUgdGhpcyBzbyB0aGUgcHJvbWlzZSBoYW5kbGVyIGNhbiBnZXQgaXRcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgLy9sb29wIG92ZXIgdGhlIGFycmF5IGNhbGxpbmd1cGRhdGUgb24gZWFjaFxyXG4gICAgZm9yICh2YXIga2V5IGluIG1hbnl3aG8uT3V0Y29tZVRpbWVycykge1xyXG4gICAgICAgIHZhciB0aW1lciA9IG1hbnl3aG8uT3V0Y29tZVRpbWVyc1trZXldO1xyXG4gICAgICAgIGlmICh0aW1lcikge1xyXG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKHRyaWdnZXJUaW1lcih0aW1lcikpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFByb21pc2UuYWxsKHByb21pc2VzKTtcclxufVxyXG5mdW5jdGlvbiB0cmlnZ2VyVGltZXIodGltZXIpIHtcclxuICAgIC8vdGhlcmUgc2hvdWxkIGJlIGFuIGF0dHJpYnV0ZSB0byBkaWN0YXRlIGlmIHRoZSBjb21wb25lbnQgaGFkIGEgbW9kZWxcclxuICAgIHRpbWVyLnN0YXJ0Q291bnRpbmcoKTtcclxuICAgIHJldHVybiB0cnVlO1xyXG59XHJcbnZhciBSZWFjdCA9IF9fd2VicGFja19yZXF1aXJlX18oMik7XHJcbl9fd2VicGFja19yZXF1aXJlX18oMyk7XHJcbnZhciBPdXRjb21lVGltZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoT3V0Y29tZVRpbWVyLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gT3V0Y29tZVRpbWVyKHByb3BzKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XHJcbiAgICAgICAgX3RoaXMuY29tcG9uZW50SWQgPSBcIlwiO1xyXG4gICAgICAgIF90aGlzLmZsb3dLZXkgPSBcIlwiO1xyXG4gICAgICAgIF90aGlzLmF0dHJpYnV0ZXMgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgLy9ob2xkZXIgZm9yIGRhdGFyZWZyZXNoIHRpbWVyXHJcbiAgICAgICAgX3RoaXMudGltZXJJZCA9IC0xO1xyXG4gICAgICAgIF90aGlzLnRpbWVyQ291bnRlciA9IDA7XHJcbiAgICAgICAgX3RoaXMuY29tcG9uZW50SWQgPSBwcm9wcy5pZDtcclxuICAgICAgICBfdGhpcy5mbG93S2V5ID0gcHJvcHMuZmxvd0tleTtcclxuICAgICAgICAvL3B1c2ggYXR0cmlidXRlcyBpbnRvIGtleWVkIG1hcCBcclxuICAgICAgICB2YXIgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQoX3RoaXMuY29tcG9uZW50SWQsIF90aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgIGlmIChmbG93TW9kZWwuYXR0cmlidXRlcykge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gZmxvd01vZGVsLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmF0dHJpYnV0ZXMuc2V0KGtleSwgZmxvd01vZGVsLmF0dHJpYnV0ZXNba2V5XSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGZsb3dNb2RlbC5vYmplY3REYXRhICYmIGZsb3dNb2RlbC5vYmplY3REYXRhWzBdKSB7XHJcbiAgICAgICAgICAgIG1hbnl3aG8uc3RhdGUuc2V0Q29tcG9uZW50KF90aGlzLmNvbXBvbmVudElkLCB7IG9iamVjdERhdGE6IFtmbG93TW9kZWwub2JqZWN0RGF0YVswXV0gfSwgX3RoaXMuZmxvd0tleSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIE91dGNvbWVUaW1lci5wcm90b3R5cGUuZ2V0QXR0cmlidXRlID0gZnVuY3Rpb24gKGF0dHJpYnV0ZU5hbWUsIGRlZmF1bHRWYWx1ZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMuaGFzKGF0dHJpYnV0ZU5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF0dHJpYnV0ZXMuZ2V0KGF0dHJpYnV0ZU5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRlZmF1bHRWYWx1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgT3V0Y29tZVRpbWVyLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBtYW55d2hvLk91dGNvbWVUaW1lcnNbdGhpcy5jb21wb25lbnRJZF0gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc3RhcnRDb3VudGluZygpO1xyXG4gICAgfTtcclxuICAgIE91dGNvbWVUaW1lci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gdXNlIHRpbWVySWQgZnJvbSB0aGUgc3RhdGUgdG8gY2xlYXIgdGhlIGludGVydmFsc1xyXG4gICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcklkKTtcclxuICAgICAgICB0aGlzLnRpbWVySWQgPSAtMTtcclxuICAgIH07XHJcbiAgICBPdXRjb21lVGltZXIucHJvdG90eXBlLnN0YXJ0Q291bnRpbmcgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy50aW1lckNvdW50ZXIgPSAwO1xyXG4gICAgICAgIHRoaXMudGltZXJJZCA9IHdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLnRpbWVySGFuZGxlci5iaW5kKHRoaXMpLCAxMDAwKTtcclxuICAgIH07XHJcbiAgICBPdXRjb21lVGltZXIucHJvdG90eXBlLnRpbWVySGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICBpZiAoZmxvd1N0YXRlICYmIGZsb3dTdGF0ZS5sb2FkaW5nKSB7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXJDb3VudGVyID0gMDtcclxuICAgICAgICAgICAgdGhpcy5mb3JjZVVwZGF0ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMudGltZXJDb3VudGVyIDwgcGFyc2VJbnQodGhpcy5nZXRBdHRyaWJ1dGUoXCJyZWZyZXNoSW50ZXJ2YWxTZWNvbmRzXCIsIDEwKSkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGltZXJDb3VudGVyKys7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvL3Jlc2V0IHRoZSBjb3VudGVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyQ291bnRlciA9IDA7XHJcbiAgICAgICAgICAgICAgICAvL3N3aXRjaCBvZmYgdGhlIHRpbWVyXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aW1lcklkID49IC0xKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVySWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMudGltZXJJZCA9IC0xO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIG91dGNvbWVUb1RyaWdnZXIgPSB0aGlzLmdldEF0dHJpYnV0ZShcInJlZnJlc2hPdXRjb21lSWRcIiwgXCJcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAob3V0Y29tZVRvVHJpZ2dlciAmJiBvdXRjb21lVG9UcmlnZ2VyLmxlbmd0aCA+IDAgJiYgb3V0Y29tZVRvVHJpZ2dlci50b0xvd2VyQ2FzZSgpICE9IFwibnVsbFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG91dGNvbWUgPSBtYW55d2hvLm1vZGVsLmdldE91dGNvbWUob3V0Y29tZVRvVHJpZ2dlciwgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAvL2RpZCB3ZSBnZXQgYW4gb3V0Y29tZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRjb21lKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciB0aGUgb3V0Y29tZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFueXdoby5jb21wb25lbnQub25PdXRjb21lKG91dGNvbWUsIG51bGwsIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIgY29tcG9uZW50VG9VcGRhdGUgPSB0aGlzLmdldEF0dHJpYnV0ZShcInJlZnJlc2hDb21wb25lbnRJZFwiLCBcIlwiKTtcclxuICAgICAgICAgICAgICAgIC8vaWYgd2Ugd2VyZSBnaXZlbiBhIGNvbXBvbmVudCBpZCB0byB1cGRhdGVcclxuICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnRUb1VwZGF0ZSAmJiBjb21wb25lbnRUb1VwZGF0ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9wcmVzZXJ2ZSB0aGlzIHNvIHRoZSBwcm9taXNlIGhhbmRsZXIgY2FuIGdldCBpdFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgICAgICAgICAvL2dldCB0aGUgb2JqZWN0RGF0YVJlcXVlc3Qgb2JqZWN0IGZyb20gdGhlIG1vZGVsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudCh0aGlzLnByb3BzLmlkLCB0aGlzLnByb3BzLmZsb3dLZXkpLm9iamVjdERhdGFSZXF1ZXN0O1xyXG4gICAgICAgICAgICAgICAgICAgIC8vZGVtYW5kIHRoZSBlbmdpbmUgcmUtZ2V0cyB0aGUgbW9kZWwgYW5kIGhhbmRsZSB0aGUgYXN5bmMgcHJvbWlzZSByZXN1bHRcclxuICAgICAgICAgICAgICAgICAgICBtYW55d2hvLmVuZ2luZS5vYmplY3REYXRhUmVxdWVzdCh0aGlzLnByb3BzLmlkLCByZXF1ZXN0LCB0aGlzLnByb3BzLmZsb3dLZXksIDAsIG51bGwsIG51bGwsIG51bGwsIG51bGwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudCA9IG1hbnl3aG8ubW9kZWwuZ2V0Q29tcG9uZW50KGNvbXBvbmVudFRvVXBkYXRlLCBzZWxmLnByb3BzLmZsb3dLZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RpZCB3ZSBnZXQgYSBjb21wb25lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbXBvbmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Lm9iamVjdERhdGEgPSBtYW55d2hvLm1vZGVsLmdldENvbXBvbmVudChzZWxmLnByb3BzLmlkLCBzZWxmLnByb3BzLmZsb3dLZXkpLm9iamVjdERhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW55d2hvLmVuZ2luZS5yZW5kZXIoc2VsZi5wcm9wcy5mbG93S2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIE91dGNvbWVUaW1lci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciByZW1haW5pbmcgPSBwYXJzZUludCh0aGlzLmdldEF0dHJpYnV0ZShcInJlZnJlc2hJbnRlcnZhbFNlY29uZHNcIiwgMTApKSAtIHRoaXMudGltZXJDb3VudGVyO1xyXG4gICAgICAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIG51bGwsXHJcbiAgICAgICAgICAgIFwiVHJpZ2dlcmluZyBvdXRjb21lIGluIFwiLFxyXG4gICAgICAgICAgICByZW1haW5pbmcsXHJcbiAgICAgICAgICAgIFwiIHNlY29uZHNcIik7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIE91dGNvbWVUaW1lcjtcclxufShSZWFjdC5Db21wb25lbnQpKTtcclxubWFueXdoby5jb21wb25lbnQucmVnaXN0ZXIoJ091dGNvbWVUaW1lcicsIE91dGNvbWVUaW1lcik7XHJcbmV4cG9ydHMuZGVmYXVsdCA9IE91dGNvbWVUaW1lcjtcclxuXG5cbi8qKiovIH0pLFxuLyogMiAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJlYWN0O1xuXG4vKioqLyB9KSxcbi8qIDMgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuLy8gcmVtb3ZlZCBieSBleHRyYWN0LXRleHQtd2VicGFjay1wbHVnaW5cblxuLyoqKi8gfSlcbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBPdXRjb21lVGltZXIuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHtcbiBcdFx0XHRcdGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuIFx0XHRcdFx0Z2V0OiBnZXR0ZXJcbiBcdFx0XHR9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSAwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCAzM2U2NzQ2YWQwOTYxNDY1YTQ5YSIsImV4cG9ydCAqIGZyb20gJy4vT3V0Y29tZVRpbWVyJztcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9pbmRleC50c3giLCJcclxuZGVjbGFyZSB2YXIgbWFueXdobzogYW55O1xyXG5cclxubWFueXdoby5PdXRjb21lVGltZXJzID0ge307XHJcbi8vIHRoaXMgYXR0YWNoZXMgdGhlIEFqYXggaGFuZGxlcnMgdG8gdGhlIG1hbnl3aG8uQ3VzdG9tQ29tcG9uZW50T3JjaGVzdHJhdG9yIG9yIFxyXG4vLyBpbml0aWFsaXplIGZ1bmN0aW9uIGlmIG1hbnl3aG8uQ3VzdG9tQ29tcG9uZW50T3JjaGVzdHJhdG9yIGlzbnQgZGVmaW5lZC4gIFxyXG5pZihtYW55d2hvLkN1c3RvbUNvbXBvbmVudE9yY2hlc3RyYXRvcilcclxue1xyXG4gICAgbWFueXdoby5DdXN0b21Db21wb25lbnRPcmNoZXN0cmF0b3IuZG9uZVNlbmRIYW5kbGVycy5wdXNoKGRvbmVIYW5kbGVyKTtcclxufVxyXG5lbHNlXHJcbntcclxuICAgIG1hbnl3aG8uc2V0dGluZ3MuaW5pdGlhbGl6ZShcclxuICAgICAgICB7XHJcbiAgICAgICAgfVxyXG4gICAgICAgICxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGludm9rZTogXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICBkb25lOiBkb25lSGFuZGxlciAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRvbmVIYW5kbGVyKClcclxue1xyXG4gICAgLy9wcmVzZXJ2ZSB0aGlzIHNvIHRoZSBwcm9taXNlIGhhbmRsZXIgY2FuIGdldCBpdFxyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHZhciBwcm9taXNlcyA9IFtdO1xyXG4gICAgLy9sb29wIG92ZXIgdGhlIGFycmF5IGNhbGxpbmd1cGRhdGUgb24gZWFjaFxyXG4gICAgZm9yKHZhciBrZXkgaW4gbWFueXdoby5PdXRjb21lVGltZXJzKVxyXG4gICAge1xyXG4gICAgICAgIHZhciB0aW1lciA6IE91dGNvbWVUaW1lciA9IG1hbnl3aG8uT3V0Y29tZVRpbWVyc1trZXldO1xyXG5cclxuICAgICAgICBpZih0aW1lcilcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2godHJpZ2dlclRpbWVyKHRpbWVyKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIFByb21pc2UuYWxsKHByb21pc2VzKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdHJpZ2dlclRpbWVyKHRpbWVyIDogT3V0Y29tZVRpbWVyKVxyXG57XHJcbiAgICBcclxuICAgIC8vdGhlcmUgc2hvdWxkIGJlIGFuIGF0dHJpYnV0ZSB0byBkaWN0YXRlIGlmIHRoZSBjb21wb25lbnQgaGFkIGEgbW9kZWxcclxuICAgIHRpbWVyLnN0YXJ0Q291bnRpbmcoKTtcclxuICAgIHJldHVybiB0cnVlOyBcclxufVxyXG5cclxuXHJcblxyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCAnLi9PdXRjb21lVGltZXIuY3NzJztcclxuXHJcbmNsYXNzIE91dGNvbWVUaW1lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxhbnksIGFueT4gXHJcbntcclxuICAgXHJcbiAgICBjb21wb25lbnRJZDogc3RyaW5nID0gXCJcIjtcclxuICAgIGZsb3dLZXk6IHN0cmluZyA9XCJcIjsgIFxyXG4gICAgYXR0cmlidXRlcyA9IG5ldyBNYXA8c3RyaW5nLGFueT4oKTtcclxuXHJcbiAgICAvL2hvbGRlciBmb3IgZGF0YXJlZnJlc2ggdGltZXJcclxuICAgIHRpbWVySWQgPSAtMTtcclxuICAgIHRpbWVyQ291bnRlciA9IDA7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJvcHMgOiBhbnkpXHJcblx0e1xyXG4gICAgICAgIHN1cGVyKHByb3BzKTtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLmNvbXBvbmVudElkID0gcHJvcHMuaWQ7XHJcbiAgICAgICAgdGhpcy5mbG93S2V5ID0gcHJvcHMuZmxvd0tleTtcclxuXHJcbiAgICAgICAgLy9wdXNoIGF0dHJpYnV0ZXMgaW50byBrZXllZCBtYXAgXHJcblx0XHR2YXIgZmxvd01vZGVsID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgICB0aGlzLmZsb3dLZXkpO1xyXG5cdFx0aWYoZmxvd01vZGVsLmF0dHJpYnV0ZXMpXHJcblx0XHR7XHJcblx0XHRcdGZvcih2YXIga2V5IGluIGZsb3dNb2RlbC5hdHRyaWJ1dGVzKVxyXG5cdFx0XHR7XHJcblx0XHRcdFx0dGhpcy5hdHRyaWJ1dGVzLnNldChrZXkgLGZsb3dNb2RlbC5hdHRyaWJ1dGVzW2tleV0pO1xyXG5cdFx0XHR9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZihmbG93TW9kZWwub2JqZWN0RGF0YSAmJiBmbG93TW9kZWwub2JqZWN0RGF0YVswXSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIG1hbnl3aG8uc3RhdGUuc2V0Q29tcG9uZW50KHRoaXMuY29tcG9uZW50SWQsIHtvYmplY3REYXRhOiBbZmxvd01vZGVsLm9iamVjdERhdGFbMF1dfSwgdGhpcy5mbG93S2V5LCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0QXR0cmlidXRlKGF0dHJpYnV0ZU5hbWUgOiBzdHJpbmcsIGRlZmF1bHRWYWx1ZSA6IGFueSlcclxuXHR7XHJcblx0XHRpZih0aGlzLmF0dHJpYnV0ZXMuaGFzKGF0dHJpYnV0ZU5hbWUpKVxyXG5cdFx0e1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLmdldChhdHRyaWJ1dGVOYW1lKTtcclxuXHRcdH1cclxuXHRcdGVsc2VcclxuXHRcdHtcclxuXHRcdFx0cmV0dXJuIGRlZmF1bHRWYWx1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG4gICAgY29tcG9uZW50RGlkTW91bnQoKSBcclxuICAgIHsgICBcclxuICAgICAgICBtYW55d2hvLk91dGNvbWVUaW1lcnNbdGhpcy5jb21wb25lbnRJZF0gPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuc3RhcnRDb3VudGluZygpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KClcclxuICAgIHtcclxuICAgICAgICAvLyB1c2UgdGltZXJJZCBmcm9tIHRoZSBzdGF0ZSB0byBjbGVhciB0aGUgaW50ZXJ2YWxzXHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVySWQpO1xyXG4gICAgICAgIHRoaXMudGltZXJJZCA9IC0xO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXJ0Q291bnRpbmcoKVxyXG4gICAge1xyXG4gICAgICAgIHRoaXMudGltZXJDb3VudGVyID0gMDtcclxuICAgICAgICB0aGlzLnRpbWVySWQgPSB3aW5kb3cuc2V0SW50ZXJ2YWwodGhpcy50aW1lckhhbmRsZXIuYmluZCh0aGlzKSwgMTAwMCk7XHJcbiAgICB9XHJcblxyXG5cclxuICAgIHRpbWVySGFuZGxlcigpXHJcbiAgICB7XHJcbiAgICAgICAgY29uc3QgZmxvd1N0YXRlID0gbWFueXdoby5zdGF0ZS5nZXRDb21wb25lbnQodGhpcy5jb21wb25lbnRJZCwgdGhpcy5mbG93S2V5KTtcclxuICAgICAgICBcclxuICAgICAgICBpZihmbG93U3RhdGUgJiYgZmxvd1N0YXRlLmxvYWRpbmcpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyQ291bnRlciA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yY2VVcGRhdGUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYodGhpcy50aW1lckNvdW50ZXIgPCBwYXJzZUludCh0aGlzLmdldEF0dHJpYnV0ZShcInJlZnJlc2hJbnRlcnZhbFNlY29uZHNcIiwgMTAgKSkpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudGltZXJDb3VudGVyKys7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAvL3Jlc2V0IHRoZSBjb3VudGVyXHJcbiAgICAgICAgICAgICAgICB0aGlzLnRpbWVyQ291bnRlciA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9zd2l0Y2ggb2ZmIHRoZSB0aW1lclxyXG4gICAgICAgICAgICAgICAgaWYodGhpcy50aW1lcklkID49IC0xKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcklkKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWVySWQgPSAtMTsgXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHZhciBvdXRjb21lVG9UcmlnZ2VyID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJyZWZyZXNoT3V0Y29tZUlkXCIsIFwiXCIpXHJcblxyXG4gICAgICAgICAgICAgICAgaWYob3V0Y29tZVRvVHJpZ2dlciAmJiBvdXRjb21lVG9UcmlnZ2VyLmxlbmd0aCA+IDAgJiYgb3V0Y29tZVRvVHJpZ2dlci50b0xvd2VyQ2FzZSgpICE9IFwibnVsbFwiKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvdXRjb21lID0gbWFueXdoby5tb2RlbC5nZXRPdXRjb21lKG91dGNvbWVUb1RyaWdnZXIsIHRoaXMuZmxvd0tleSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vZGlkIHdlIGdldCBhbiBvdXRjb21lXHJcbiAgICAgICAgICAgICAgICAgICAgaWYob3V0Y29tZSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdHJpZ2dlciB0aGUgb3V0Y29tZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWFueXdoby5jb21wb25lbnQub25PdXRjb21lKG91dGNvbWUsIG51bGwgLCB0aGlzLmZsb3dLZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNvbXBvbmVudFRvVXBkYXRlID0gdGhpcy5nZXRBdHRyaWJ1dGUoXCJyZWZyZXNoQ29tcG9uZW50SWRcIiwgXCJcIilcclxuICAgICAgICAgICAgICAgIC8vaWYgd2Ugd2VyZSBnaXZlbiBhIGNvbXBvbmVudCBpZCB0byB1cGRhdGVcclxuICAgICAgICAgICAgICAgIGlmKGNvbXBvbmVudFRvVXBkYXRlICYmIGNvbXBvbmVudFRvVXBkYXRlLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9wcmVzZXJ2ZSB0aGlzIHNvIHRoZSBwcm9taXNlIGhhbmRsZXIgY2FuIGdldCBpdFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9nZXQgdGhlIG9iamVjdERhdGFSZXF1ZXN0IG9iamVjdCBmcm9tIHRoZSBtb2RlbFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQodGhpcy5wcm9wcy5pZCwgICB0aGlzLnByb3BzLmZsb3dLZXkpLm9iamVjdERhdGFSZXF1ZXN0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL2RlbWFuZCB0aGUgZW5naW5lIHJlLWdldHMgdGhlIG1vZGVsIGFuZCBoYW5kbGUgdGhlIGFzeW5jIHByb21pc2UgcmVzdWx0XHJcbiAgICAgICAgICAgICAgICAgICAgbWFueXdoby5lbmdpbmUub2JqZWN0RGF0YVJlcXVlc3QodGhpcy5wcm9wcy5pZCwgcmVxdWVzdCwgdGhpcy5wcm9wcy5mbG93S2V5LCAwICwgbnVsbCwgbnVsbCwgbnVsbCwgbnVsbClcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcG9uZW50ID0gbWFueXdoby5tb2RlbC5nZXRDb21wb25lbnQoY29tcG9uZW50VG9VcGRhdGUsIHNlbGYucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RpZCB3ZSBnZXQgYSBjb21wb25lbnRcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoY29tcG9uZW50KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQub2JqZWN0RGF0YT1tYW55d2hvLm1vZGVsLmdldENvbXBvbmVudChzZWxmLnByb3BzLmlkLCBzZWxmLnByb3BzLmZsb3dLZXkpLm9iamVjdERhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYW55d2hvLmVuZ2luZS5yZW5kZXIoIHNlbGYucHJvcHMuZmxvd0tleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0gIFxyXG4gICAgXHJcbiAgICByZW5kZXIoKSBcclxuICAgIHtcclxuICAgICAgICB2YXIgcmVtYWluaW5nID0gcGFyc2VJbnQodGhpcy5nZXRBdHRyaWJ1dGUoXCJyZWZyZXNoSW50ZXJ2YWxTZWNvbmRzXCIsIDEwICkpIC0gdGhpcy50aW1lckNvdW50ZXJcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gPGRpdj5UcmlnZ2VyaW5nIG91dGNvbWUgaW4ge3JlbWFpbmluZ30gc2Vjb25kczwvZGl2PiAgIFxyXG4gICAgfVxyXG59XHJcblxyXG5tYW55d2hvLmNvbXBvbmVudC5yZWdpc3RlcignT3V0Y29tZVRpbWVyJywgT3V0Y29tZVRpbWVyKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IE91dGNvbWVUaW1lcjtcclxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL091dGNvbWVUaW1lci50c3giLCJtb2R1bGUuZXhwb3J0cyA9IFJlYWN0O1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIGV4dGVybmFsIFwiUmVhY3RcIlxuLy8gbW9kdWxlIGlkID0gMlxuLy8gbW9kdWxlIGNodW5rcyA9IDAiXSwic291cmNlUm9vdCI6IiJ9